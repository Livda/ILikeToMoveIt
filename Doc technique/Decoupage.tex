\chapter{Découpage}
Notre projet est composé de 5 Bundles.

\section{MainBundle}
Ce Bundle est celui qui gère ce qui est en rapport avec les pages d'accueils et les cron, il contiens les entities "générales"

\subsection{Entities}
\subsubsection{Department}
Représente les départements, actuellement sont présents les 7 départements de l'insa et le département ALL qui sert pour les limites informatives global à tout les départements et servira probablement pour le service RI si un jour son rôle viens à être ajouté dans l'application.

\subsubsection{Year}
Représente les années, c'est l'année la plus basse de l'année scolaire qui est stocké, exemple, pour 2015/2016, c'est 2015 qui est dans la base. L'année courante est l'année la plus grande dans la base. Une méthode dans le repository permet de la récupéré directement.

\subsubsection{CronTask}
Ces objets sont regarder régulièrement parle serveur (toutes les 5/1 0minutes) via Mb/MainBundle/Command/CronTasksRunCommand.php . 
Si la date de dernière run + interval est dépassé, alors les commandes stocké sont exécutés, la création de nouvelle commande se fait dans le dossier Mb/MainBundle/Command. 

Actuellement il y a la commande main:newYear qui existe, pour crée une nouvelle année fin août. Et rendre les utilisateurs inactifs s'ils ne se sont pas connecté depuis 5 ans.


\subsection{Views}
Il y as trois views dans ce Bundle, une pour la page d'accueil Admin/SuperAdmin, une pour la page d'accueil étudiant et la dernière la page d'identification.

\subsection{Controller}
\subsubsection{DepartmentController}
Contiens les routes pour dérouiller ou déverrouiller la possibilité de faire des voeux pour les étudiants du département de l'utilisateur courant.

\subsubsection{MainController}
Contiens la redirection vers les bonnes page selon notre niveau d'identification quand on va sur la racine du site.
Il contiens aussi les méthodes des pages d'accueils.

Une route est désactivée, elle a servie à l'ajout de la CronTask newYear et peux servir pour l'ajout de n'importe quelle nouvelle CronTask.

\subsubsection{SecurityController}
Sert à l'identification.

\section{UserBundle}
Ce Bundle gère les utilisateurs et leur authentification.

\subsection{Entities}
\subsubsection{User}
Représente les utilisateurs de la base, cette classe hérite de FOSuser. Plusieurs fonctions de sélections utile sont présentent dans le repository.

\subsection{Views}
La seule view sert aux import d'utilisateurs et d'admin quand on est SuperAdmin.

\subsection{Controller}
\subsubsection{UserController}
La principale route de ce controller est l'ajout d'étudiant/admin.
Sont aussi présentes celles pour ajouter une moyenne, un commentaire, supprimer un utilisateur, permettre au SuperAdmin de changer de département.


\subsection{Ldap}
Quand une entité est chargée du ldap via les méthode dans UserController, c'est Mb/Userbundle/Ldap/LdapManager.php qui est appelé.
Les paramètres du ldap se trouvent dans app/config/config.yml


\section{FileBundle}
\subsection{Entities}
\subsubsection{FileSend}
Les fichiers envoyé parles utilisateurs. Possède une méthode PreRemove pour supprimer le fichier du système avant la suppression de l'entité.

\subsubsection{FileToComplete}
Entité non finie, normalement prévue pour les fichiers à complété pour certains pays/universités, exemple: contrat d'études, contrat de mobilité, formulaire de sécurité sociale Québec, etc.


\subsection{Controller}
\subsubsection{FileController}
Une seule méthode, pour supprimer un fichier.


\section{UniversityBundle}
\subsection{Entities}
\subsubsection{Country}